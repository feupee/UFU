---
title: "Lista 01"
author: "Matheus Dantas e Felipe Santos"
format: html
editor: visual
lang: "pt-br"
---

# ExercÃ­cio 1

Crie os seguintes vetores: a) (10, 11, 12,â€¦, 30) b) (30, 29, 28,â€¦, 10) c) (10, 11, 12,â€¦, 30, 29, 28,â€¦, 10)

```{r}
vetorA <- 10:30

vetorB <- 30:10

vetorC <- c(vetorA, vetorB)
```

# ExercÃ­cio 2

Use a funÃ§Ã£o help do R para descobrir o funcionamento das funÃ§Ãµes rep e seq. Em seguida, utilize estas funÃ§Ãµes para resolver os seguintes itens:

## a)

Crie o vetor (2, 4, 6, 8, 2, 4, 6, 8,â€¦, 2, 4, 6, 8), em que hÃ¡ dez ocorrÃªncias do nÃºmero 2.

```{r}
vetorOcorrencia2 <- rep(seq(2, 8, length.out = 4), 10)
```

## b)

Crie o vetor (2, 4, 6, 8, 2, 4, 6, 8,â€¦, 2, 4, 6, 8, 2), em que hÃ¡ onze ocorrÃªncias do nÃºmero 2 e dez ocorrÃªncias dos nÃºmeros 4, 6 e 8.

```{r}
vetorOcorrencia3 <- c(rep(seq(2, 8, by = 2), 10), 2)
```

# ExercÃ­cio 3

Utilize a estrutura de vetores do R para realizar as seguintes somas:

## a)

âˆ‘n=20-\>30(ğ‘›2 + 4ğ‘›);

```{r}
soma1 <- 20:30
soma1 <- (soma1**2) + (4 * soma1)
soma1 <- sum(soma1)
soma1
```

## b)

âˆ‘n=10-\>20(3\^ğ‘›/ğ‘› + 2^ğ‘›/n^2)

```{r}
soma2 <- 10:20
soma2 <- (3**soma2)/soma2 + (2**soma2)/(soma2**2)
soma2 <- sum(soma2)
soma2
```

# ExercÃ­cio 4

Numa urna hÃ¡ bolas idÃªnticas numeradas de 1 atÃ© 100. SerÃ£o extraÃ­das 40 bolas com reposiÃ§Ã£o desta urna. Simule este experimento e guarde o resultado dos sorteios em um vetor.

```{r}
resultadoSorteio <- sample(1:100, size = 40, replace = TRUE)
resultadoSorteio
```

## a)

Quantas bolas pares foram sorteadas?

```{r}
QuantidadePares <- sum(resultadoSorteio%%2==0)
QuantidadePares
```

## b)

Quantas bolas maiores do que 70 foram sorteadas?

```{r}
QuantidadeMaior70 <- sum(resultadoSorteio>70)
QuantidadeMaior70
```

## c)

Em quais retiradas (posiÃ§Ãµes) foram sorteadas as bolas Ã­mpares?

```{r}
posicoesimpares <- which(resultadoSorteio%%2!=0)
posicoesimpares
```

# ExercÃ­cio 5

Crie um funÃ§Ã£o no R que irÃ¡ simular sucessivos lanÃ§amentos de um dado atÃ© que o nÃºmero 4 seja obtido pela segunda vez. A funÃ§Ã£o deverÃ¡ retornar o nÃºmero de lanÃ§amentos que foram necessÃ¡rios atÃ© o 4 ser obtido pela segunda vez. Assim, se os sorteios foram 3, 6, 6, 5, 4, 2, 4 a funÃ§Ã£o deverÃ¡ retornar 7.

```{r}
quatroPelaSegundaVez <- function(){
  lancamentos <- c()
  repeat{
    dado <- c(sample(x = 1:6, size = 1, replace = TRUE))
    lancamentos <- c(lancamentos, dado)
    
    if(sum(c(lancamentos == 4 )) > 1)
      break
  }
  return(length(lancamentos))
}

quatroPelaSegundaVez()
```

# ExercÃ­cio 6

Utilize a funÃ§Ã£o do exercÃ­cio anterior para replicar o experimento dez mil vezes. Para cada replicaÃ§Ã£o, guarde o nÃºmero de lanÃ§amentos num vetor chamado quantidades. Por fim, calcule a mÃ©dia de quantidades. Interprete o resultado obtido.

```{r}
quantidades <- replicate(10000, quatroPelaSegundaVez())
mean(quantidades)
# Em mÃ©dia, Ã© nescessÃ¡rio jogar o dado 12 vezes, para que se obtenha o numero o mesmo numero duas vezes. Ou seja, em mÃ©dia, passamos por todos os nÃºmeros do dado ao arremesÃ¡-lo 12 vezes
```

# ExercÃ­cio 7

Os dois primeiros termos da sequÃªncia de Fibonacci sÃ£o iguais a 1. Os termos subsequentes da sequÃªncia sÃ£o encontrados somando os dois termos imediatamente anteriores. Escreva uma funÃ§Ã£o com parÃ¢metro de entrada n chamada fibonacci que retornarÃ¡ os primeiros n termos da sequÃªncia de Fibonacci para qualquer ğ‘› â‰¥ 3. Exemplo: fibonacci(10) \[1\] 1 1 2 3 5 8 13 21 34 55

```{r}
fibonacci <- function(n){
  fib <- c(1,1)
  for(i in 1:n-1){
    novo <- fib[i-1] + fib[i]
    fib <- c(fib, novo)
  }
  return(fib)
}

fibonacci(15)
```

# ExercÃ­cio 8

Michael Scott Ã© gerente regional da empresa Dunder Mufflin. Para as festividades de fim de ano, Michael propÃ´s aos funcionÃ¡rios Dwight Schrute, Jim Halpert, Kevin Malone e Creed Bratton a realizaÃ§Ã£o de um amigo oculto entre eles. Consideraremos que o sorteio do amigo oculto deu errado quando uma pessoa sortear ela mesma (Michael tira Michael, por exemplo). Simule o sorteio do amigo oculto. Se ele deu certo, atribua o valor 1; caso contrÃ¡rio, atribua o valor 0 (zero). Em seguida, replique este experimento cem mil vezes e calcule a proporÃ§Ã£o de vezes que o amigo oculto deu errado.

```{r}
AmigoOculto <- function(nomes) {
    # Embaralha os nomes aleatoriamente
    sorteio <- sample(nomes)
    
    # Verifica se alguÃ©m se sorteou a si mesmo ou seja compara cada elemento do vetor sorteio com o vetor nomes
    if (!any(sorteio == nomes)) {
      return(TRUE)  # Sorteio vÃ¡lido
    }else{
      return(FALSE)
    }
}
# Nomes
nomes <- c("Dwight Schrute", "Jim Halpert", "Kevin Malone", "Creed Bratton")

# Executa a funÃ§Ã£o 100.000 vezes
resultados <- replicate(100000, AmigoOculto(nomes))

# Verifica a proporÃ§Ã£o de sorteios vÃ¡lidos
proporcao <- mean(resultados)
print(proporcao)

```

# ExercÃ­cio 9

No jogo de Craps dois dados sÃ£o lanÃ§ados: â€¢ se a soma for 7 ou 11, vocÃª ganha o jogo; â€¢ se a soma for 2,3 ou 12, vocÃª perde o jogo; â€¢ caso contrÃ¡rio, os dois dados sÃ£o rolados novamente atÃ© obter-se 7 (vocÃª perde) ou atÃ© obter-se a soma inicial (vocÃª ganha). Simule uma partida do jogo de Craps. Em seguida, replique este experimento 100 mil vezes; para cada experimento, atribua 1 para uma vitÃ³ria e zero para uma derrota. Calcule a proporÃ§Ã£o de vezes que vocÃª ganhou o jogo. Exemplo: as seguintes sequÃªncias (cada entrada Ã© a soma dos dois dados) resultam em vitÃ³ria: (7), (11), (5, 4, 5), (4, 5, 6, 12, 4); as seguintes sequÃªncias resultam em derrota: (2), (4, 11, 7), (8, 5, 2, 3, 9, 7

```{r}
craps <- function(){
    #lanÃ§a dois dados
    lancamento <- sample(x = 1:6, size = 2, replace = TRUE) 
    somaInicial <- sum(lancamento) #soma
    if(somaInicial %in% c(7,11)){ #se foi 7 ou 11, ganha
      return(TRUE)
    }else if(somaInicial %in% c(2,3,12)){ # se foi 2,3 ou 12, perde
      return(FALSE)
    }else{ #se nao, repete  atÃ©...
      repeat{
        lancamento <- sample(x = 1:6, size = 2, replace = TRUE)
        soma <- sum(lancamento)
        if(soma == 7){ #soma 7 perde
          return(FALSE)
        }else if(soma == somaInicial){ #soma igual a inicial ganha
          return(TRUE)
        }
      }
    }
}

craps()
jogos <- replicate(100000, craps())
mean(jogos)
```

# ExercÃ­cio 10

Luke Skywalker realizarÃ¡ o seguinte passeio aleatÃ³rio na reta: a reta do passeio Ã© formada pelos nÃºmeros inteiros de zero atÃ© ğ‘; Luke estÃ¡ em um ponto ğ¿ que Ã© maior do que zero e menor do que ğ‘;Luke lanÃ§a uma moeda honesta; se sair coroa, ele dÃ¡ um passo para a esquerda (e termina na posiÃ§Ã£o ğ¿ âˆ’ 1 da reta); se sair cara, ele dÃ¡ um passo para a direita (e termina na posiÃ§Ã£o ğ¿ + 1 da reta). Luke continuarÃ¡ a lanÃ§ar a moeda e se deslocarÃ¡ atÃ© que ele chegue em sua casa (e lÃ¡ ele vai dormir e o passeio acaba) ou atÃ© que ele chegue (caia) no precipÃ­cio (e, Ã³bvio, o passeio tambÃ©m acaba nesse caso).

## a)

Para ğ‘ = 20, crie uma funÃ§Ã£o cuja entrada seja ğ¿ (um nÃºmero maior do que zero e menor do que 20) e que retorne 1 se Luke terminou um passeio em sua casa ou retorne zero se Luke caiu no precipÃ­cio.

```{r}
Passeio <- function(Ponto_L){
    
    while (TRUE) {  # Continua enquanto Ponto_L for maior que 0
      if(Ponto_L == 20){
        return(1) #Luke concluio o passeio
      }
      if(Ponto_L == 0){
        return(0) #Luke caio no precipÃ­cio
      }
      resultado_caracoroa <- sample(c(0, 1), 1)  # 0 para cara, 1 para coroa
      if (resultado_caracoroa == 0) {
        Ponto_L <- Ponto_L + 1
      } else {
        Ponto_L <- Ponto_L - 1
      }
    }
    
    return(Ponto_L)
  }
  
  # Executa a funÃ§Ã£o 10 vez
  resultado <- replicate(10, Passeio(10)) #Pode ser substituido por qualquer valor
  print(resultado)

```

## b)

Crie uma funÃ§Ã£o cuja entrada seja ğ¿; esta funÃ§Ã£o deverÃ¡ replicar o passeio da letra (a) 10 mil vezes e retornar a proporÃ§Ã£o de vezes que Luke chegou em sua casa. SugestÃ£o: crie um vetor que, para cada replicaÃ§Ã£o, guardarÃ¡ o resultado de um passeio; cada entrada deste vetor serÃ¡ zero ou 1; zero se Luke caiu no precipÃ­cio e 1 se Luke chegou em casa.

```{r}
# Executa a funÃ§Ã£o 10000 vez
  resultado <- replicate(10000, Passeio(10))
  mean(resultado) # JÃ¡ considera 1 como os valores verdadeiro e faz a proporÃ§Ã£o em cima deles

```

## c)

Use a funÃ§Ã£o criada em (b) para ğ¿ = 1, 2, â€¦ , 19 e, em seguida, use esses valores para plotar um grÃ¡fico de ğ‘¥ = 1 âˆ¶ 19 por ğ‘¦, em que ğ‘¦ sÃ£o as proporÃ§Ãµes retornadas pela funÃ§Ã£o criada em (b) para cada ğ‘¥

```{r}
# Vetor para armazenar os resultados das proporÃ§Ãµes
  resultados_proporcao <- numeric(19)
  
  # Loop para calcular as proporÃ§Ãµes para cada valor de L de 1 a 19
  for (i in 1:19) {
    resultados <- replicate(10000, Passeio(i))
    proporcao <- mean(resultados)
    resultados_proporcao[i] <- proporcao
  }
  
  # Criar um data frame para usar no ggplot
  df_resultados <- data.frame(L = 1:19, Proporcao = resultados_proporcao)
  
  # Carregar a biblioteca ggplot2 se ainda nÃ£o estiver carregada
  library(ggplot2)
  
  # Plotar o grÃ¡fico de barras das proporÃ§Ãµes
  ggplot(data = df_resultados, aes(x = as.factor(L), y = Proporcao)) +
    geom_bar(stat = "identity", fill = "blue") +
    labs(x = "L", y = "ProporÃ§Ã£o MÃ©dia") +
    theme_minimal()

```

# ExercÃ­cio 11

Link desperta apÃ³s um sono de cem anos e encontra o reino de Hyrule em ruÃ­nas, necessi- tando recuperar suas memÃ³rias e enfrentar o mal desencadeado por Calamity Ganon. Desprovido de suas lembranÃ§as, Link adota um mÃ©todo peculiar para explorar o reino: lanÃ§ando um dado de 4 lados. As faces deste dado sÃ£o rotuladas como ğ¿, ğ‘…, ğ‘ˆ e ğ·. A direÃ§Ã£o de cada passo que Link dÃ¡ Ã© determinada pelo resultado do dado que ele lanÃ§a: se sair ğ¿ ele dÃ¡ um passo para a esquerda; se sair ğ‘…, ele dÃ¡ um passo para a direita; se sair ğ‘ˆ , ele dÃ¡ um passo para cima; se sair ğ·, ele dÃ¡ um passo para baixo. Suponha que Link comece sua jornada no ponto (0, 0) e que os quatro primeiros lanÃ§amentos do dado foram ğ‘…, ğ‘ˆ , ğ¿ e ğ¿. Portanto, a sequÃªncia de passos de Link, neste caso, Ã©: (0, 0) â†’ (1, 0) â†’ (1, 1) â†’ (0, 1) â†’ (âˆ’1, 1). As Figuras 1, 2 e 3 apresentam, respectivamente, Link no inÃ­cio de sua jornada, apÃ³s o primeiro lanÃ§amento do dado e apÃ³s o segundo lanÃ§amento do dado; a Figura 4 apresenta o percurso total feito por Link apÃ³s os quatro lanÃ§amentos.

## a)

Simule um passeio de 8 passos com Link comeÃ§ando na origem. A saÃ­da desta simulaÃ§Ã£o deve apresentar o ponto do plano em que Link estÃ¡ apÃ³s os 8 passos

```{r}
link <- function(n){
  pos <- c(0, 0)
  dado <- c('U','D','L','R')
  resultados <- sample(x = dado, size = n, replace = TRUE)
  for(i in resultados){
    if(i == 'U')
      pos <- pos+c(0,1)
    else if(i == 'D')
      pos <- pos+c(0,-1)
    else if(i == 'L')
      pos <- pos+c(-1,0)
    else if(i == 'R')
      pos <- pos+c(1,0)
  }
  return(pos)
}
n <- 8
link(n)
```

## b

Agora replique dez mil vezes o experimento de (a) e determine a proporÃ§Ã£o de vezes em que Link retornou para a origem depois de 8 passos. Comente o que esta proporÃ§Ã£o significa.

```{r}
n <- 8
#adiciona num vetor booleano 10000 vezes se o resultado da funÃ§Ã£o link() Ã© igual a (0,0)
resultados <- replicate(10000, identical(link(n), c(0,0)))
mean(resultados)

#A chance de link voltar ao inicio apÃ³s 8 passos nas 4 direÃ§Ãµes aleatoriamente Ã© de 7~8%
```

## c

Escreva uma funÃ§Ã£o em que o usuÃ¡rio entra com um nÃºmero ğ‘ : se o nÃºmero ğ‘ for Ã­mpar, entÃ£o a funÃ§Ã£o retorna: â€œimpossÃ­vel retornar a origem depois de um nÃºmero Ã­mpar de passosâ€ (quando estiver estudando esta questÃ£o, se convenÃ§a que â€™isso Ã© verdadeÃ© impossÃ­vel regressar Ã  origem em um nÃºmero de passos Ã­mpar); se o nÃºmero ğ‘ for par, entÃ£o a funÃ§Ã£o retorna uma frase informando a proporÃ§Ã£o de vezes em que Link retornou a origem depois de ğ‘ passos ao se realizar o experimento dez mil vezes.

```{r}
numeroDePassos <- function(n){
  if(n%%2 == 1){
    return("impossÃ­vel retornar a origem depois de um nÃºmero Ã­mpar de passos")
  }
  else{
    #repete a funÃ§Ã£o de (b)
    return(mean(replicate(10000, identical(link(n), c(0,0)))))
  }
}
m <- 15
numeroDePassos(m)
m <- 14
numeroDePassos(m)
```

# ExercÃ­cio 12

Considere o seguinte jogo: Steven e Garnit escolherÃ£o, cada um, uma sequÃªncia de tamanho 3 em que cada entrada da sequÃªncia Ã© cara ou coroa; logo em seguida, uma moeda serÃ¡ lanÃ§ada trÃªs vezes; se aparecer a sequÃªncia de um dos jogadores, este jogador vence e o jogo acaba; caso nÃ£o apareÃ§a a sequÃªncia de nenhum deles, a moeda Ã© lanÃ§ada pela quarta vez e os trÃªs Ãºltimos lanÃ§amentos sÃ£o analisados; se nestes trÃªs Ãºltimos lanÃ§amentos aparecer a sequÃªncia de um dos jogadores, este jogador vence e o jogo acaba. Se isto nÃ£o acontecer, a moeda Ã© lanÃ§ada pela quinta vez e os trÃªs Ãºltimos resultados sÃ£o analisados; se aparecer a sequÃªncia de um dos jogadores, este jogador vence e o jogo acaba. Este processo Ã© realizado atÃ© que apareÃ§a a sequÃªncia que um dos dois escolheu; se aparecer primeiro a sequÃªncia de Steven, ele ganha; se aparecer primeiro a sequÃªncia de Garnit, ela vence. Convencione que cara seja 1 e que coroa seja zero. Supondo que Steven escolheu a sequÃªncia (0, 1, 0) e que Garnit escolheu a sequÃªncia (0, 0, 1), simule uma partida deste jogo. A simulaÃ§Ã£o deve retornar steven caso Steven tenha vencido ou deve retornar garnit caso contrÃ¡rio. Replique o experimento 10 mil vezes e calcule a mÃ©dia de vitÃ³rias de Garnit. Comente o resultado obtido.

ObservaÃ§Ã£o: Suponha que os trÃªs primeiros lanÃ§amentos foram (1,0,0). Logo, ninguÃ©m ganhou e a moeda Ã© lanÃ§ada pela quarta vez. Suponha que o quarto lanÃ§amento foi 0; logo os trÃªs Ãºltimos lanÃ§amentos foram (0,0,0) e ninguÃ©m ganhou. Na quinta vez saiu 1 e, portanto, os trÃªs Ãºltimos lanÃ§amentos foram (0,0,1) e o jogo acaba com vitÃ³ria de Garnit. As sequÃªncias (0, 1, 0), (1, 0, 1, 0) e (1, 1, 0, 1, 0) fazem Steven vitorioso; as sequÃªncias (0, 0, 1), (0, 0, 0, 1) e (1, 0, 0, 0, 1) fazem Garnit vitoriosa.

```{r}
JogoCaraCoroa <- function(){
    
  sequenciaSteven <- c(0,1,0)
  sequenciaGarnit <- c(0,0,1)
  sequenciaCaraCoroa <- sample(c(1,0), size = 3, replace = TRUE)
  
  repeat{
      if(all(sequenciaSteven == sequenciaCaraCoroa)){
        return("steven")
      }
      if(all(sequenciaGarnit == sequenciaCaraCoroa)){
      return("garnit")
      }
    # Tirando valor mais desatualizado
    sequenciaCaraCoroa <- sequenciaCaraCoroa[-1] 
    # Adicionando um novo arremesso
    sequenciaCaraCoroa <- c(sequenciaCaraCoroa, sample(c(1,0), size = 1))
  }
  
}

resultadoCaraCoroa <- JogoCaraCoroa()
JOGOSCaraCoroa <- replicate(10000, JogoCaraCoroa())
mean(JOGOSCaraCoroa == "garnit")


# A sequencia escolhida por garnit possui, matematicamente, mais chance de ocorrer, que a sequencia escolhida por steven, logo garnit ganharÃ¡ a maioria dos jogos 
```

# ExercÃ­cio 13

Harold Frederick Shipman (Nottingham, 14 de janeiro de 1946 â€” Wakefield, 13 de janeiro de 2004), conhecido como â€œDoutor Morteâ€, foi um mÃ©dico e assassino em sÃ©rie britÃ¢nico condenado pela morte de muitos pacientes entre as dÃ©cadas de 1970 e 1990. Dr. Shipman Ã©, talvez, o assassino em sÃ©rie mais prolÃ­fico da HistÃ³ria Moderna. O arquivo dados.txt contÃ©m informaÃ§Ãµes sobre o sexo, a idade, o local da morte (casa do paciente; hospital; casa de repouso) e o ano da morte das vÃ­timas de Shipman. Antes de responder as questÃµes abaixo, abra o arquivo dados.txt e compreenda sua estrutura. Importe o arquivo para o R e utilize-o para responder os seguintes itens

```{r}
dadosHarold <- read.table("dados.txt", header = TRUE, sep = ";")
library(ggplot2)
```

## a)

Escolha um grÃ¡fico apropriado para representar as frequÃªncias das categorias da variÃ¡vel sexo. Comente os resultados encontrados

```{r}
ggplot(data = dadosHarold, mapping = aes(x = Genero, fill = Genero)) + geom_bar() + theme_gray()

# Harold matou muito mais mulheres que homens
```

## b

Apresente o histograma da variÃ¡vel idade em 8 (argumento bins na geometria do histograma) intervalos.Comente os resultados obtidos. Analise este grÃ¡fico para cada gÃªnero

```{r}
ggplot(data = dadosHarold, mapping = aes(x = Idade, fill = Genero)) + geom_histogram(bins = 8)  + theme_gray()

#Independetemente de sexo, as vitimas de harold se concentraram nos mais idosos (70 a 90). nao houveram mortes de homens na faixa de 45 a 65 anos, ou mais velhos que 90
```

## c

Apresente o boxplot da variÃ¡vel idade. Comente os resultados obtidos

```{r}
ggplot(data = dadosHarold, mapping = aes(y = Idade, fill = "lightgreen")) + geom_boxplot() + theme_gray()

# Percebe-se que grande parte de suas vÃ­timas estavam proximos aos 80 anos, e a maioria entorno dessa idade. Mas houveram casos de vÃ­timas mais jovens, com cerca de 40 e 50 anos tambÃ©m
```

## d

Apresente um grÃ¡fico para representar o local da morte. Comente os resultados obtidos

```{r}
ggplot(data = dadosHarold, mapping = aes(x = LocalDaMorte, fill = LocalDaMorte)) + geom_bar() + theme_gray()

#Claramente, Harold tinha uma preferencia em levar suas vÃ­timas atÃ© sua casa. Mas como era doutor, houveram alguns casos em hospitais e lares para idosos tambÃ©m.
```

## e

Analise graficamente o ano da morte das vÃ­timas de Harold Shipman.

```{r}
ggplot(data = dadosHarold, mapping = aes(x = AnoDaMorte, fill = "blue")) + geom_bar() + theme_gray()

#Ativo desde 75, mas com um foco em seus Ãºltimos 5 anos de atividade
```

## f

Com base nas informaÃ§Ãµes obtidas nos itens anteriores, escreva um parÃ¡grafo sobre o padrÃ£o e o perfil das vÃ­timas de Harold Shipman.

```{r}
# Com base na analise das vÃ­timas de Harold, pode-se concluir que tinha uma preferencia em levar suas vÃ­timas diretamentes para sua casa, as quais eram majoritariamente idosos. Doutor morte matou muito mais mulheres que homens e cometeu seus crimes durante 20 anos, sendo que ao longo dos anos, a quantidade de vÃ­timas tendia a crescer.

```

# ExercÃ­cio 14.

Os bonobos, tambÃ©m conhecidos como chimpanzÃ©s-pigmeus, sÃ£o encontrados apenas em uma Ã¡rea limitada da RepÃºblica DemocrÃ¡tica do Congo, na Ãfrica Central. Eles sÃ£o conhecidos por sua sociedade matriarcal, onde as fÃªmeas tÃªm um papel dominante na tomada de decisÃµes e na resoluÃ§Ã£o de conflitos. Os bonobos sÃ£o geralmente mais pacÃ­ficos do que os chimpanzÃ©s, e os conflitos dentro do grupo sÃ£o frequentemente resolvidos atravÃ©s de interaÃ§Ãµes sociais, como a partilha de alimentos e o sexo. Eles sÃ£o altamente sociais e valorizam as relaÃ§Ãµes e o contato fÃ­sico com outros membros do grupo. Por outro lado, os chimpanzÃ©s tÃªm uma distribuiÃ§Ã£o mais ampla, encontrados em vÃ¡rias regiÃµes da Ãfrica Central e Ocidental. Eles tÃªm uma sociedade mais hierÃ¡rquica e dominada por machos, onde o poder Ã© frequentemente obtido por meio de competiÃ§Ã£o e agressÃ£o. Os chimpanzÃ©s tambÃ©m exibem comportamentos violentos e podem entrar em confrontos territoriais com outros grupos. Eles sÃ£o conhecidos por usar ferramentas, como galhos para pescar cupins e pedras para quebrar nozes. O conjunto primatas.txt apresenta informaÃ§Ãµes sobre tamanho (centÃ­metros), peso (libras) e gÃªnero de bonobos e de chimpanzÃ©s. Abra o arquivo e veja como ele estÃ¡ organizado.

## a)

Importe o arquivo para o ambiente do R. ConheÃ§a sua estrutura e peÃ§a um resumo dos dados com alguma funÃ§Ã£o.

```{r}
Primatas <- read.table(file = "primatas.txt", sep = ":", header = TRUE)

str(Primatas)
summary(Primatas)
```

## b)

Construa um grÃ¡fico de barras contando quantas espÃ©cies de bonobos e chimpanzÃ©s hÃ¡ no conjunto.Construa tambÃ©m um grÃ¡fico de barras mostrando a frequÃªncia de machos e fÃªmeas de cada espÃ©cie.

```{r}
ggplot(data = Primatas, aes(x = especie, fill = genero))+
  geom_bar()+
  theme_minimal()

```

## c)

Construa um grÃ¡fico para comparar as fÃªmeas e os machos dos bonobos. Em seguida, construa, tambÃ©m, um grÃ¡fico para comparar as fÃªmeas e os machos dos chimpanzÃ©s

```{r}
ggplot(Primatas, aes(x = altura, y = peso, color = genero)) +
  geom_point() +  # Pontos para cada observaÃ§Ã£o
  facet_wrap(~especie) +  # separar Bonobos e ChimpanzÃ©s
  theme_minimal()

```

## d)

Construa um grÃ¡fico para comparar as fÃªmeas dos bonobos e dos chimpanzÃ©s. Em seguida, construa tambÃ©m um grÃ¡fico para comparar os machos dos bonobos e dos chimpanzÃ©s

```{r}

ggplot(Primatas, aes(x = altura, y = peso, color = especie)) +
  geom_point() +
  facet_wrap(~genero) +  # separar por genero
  theme_minimal()  

```

## e)

A partir das anÃ¡lises dos itens anteriores, escreva um pequeno texto contendo informaÃ§Ãµes sobre os bonobos e os chimpanzÃ©s, como exemplo: diferenÃ§as entre os gÃªneros de cada espÃ©cie e diferenÃ§as entre as espÃ©cies

```{r}
 #R: Foi apresentado dados aproximados de 1000 macacos, tendo em mÃ©dia 500 bonobos e 500 chimpazes, sendo eles em mÃ©dia 250 fÃªmeas e 250 machos cada. Ã‰ pssÃ­vel perceber que os Bonobos em relaÃ§Ã£o aos chipamzÃ©s sÃ£o menores, porÃ©m os bonobos machos em comparaÃ§Ã£o com as fÃªmeas dos chipamzÃ©s tem dados de peso/altura parecidos. Ã‰ possÃ­vel perceber tambÃ©m que dentre os bonobos e chipamzÃ©s os machos sÃ£o predominantemente maiores que as fÃªmeas em relaÃ§Ã£o a peso/altura.
```

## f)

A partir das variÃ¡veis tamanho, peso e genero, construa um modelo de Ã¡rvore de decisÃ£o utilizando estruturas condicionais que seja capaz de prever a espÃ©cie de uma observaÃ§Ã£o. Calcule a acurÃ¡cia do modelo

```{r}
Primatas <- Primatas[sample(nrow(Primatas)), ]

n <- round(0.8*nrow(Primatas))

treinamento <- Primatas[1:n,]

teste <- Primatas[-(1:n),]

resultados <- c() #vetor para armazenar as previsÃµes do modelo

for (i in 1:nrow(teste)) {
     if (teste$peso[i] > 52) {
         resultados[i] <- "chimpanze"
       } else if (teste$peso[i] >= 39 & teste$altura[i] >= 128) {
           resultados[i] <- "bonobo"
         } else if (teste$peso[i] >= 39 & teste$altura[i] < 128) {
             resultados[i] <- "chimpanze"
           } else{
               resultados[i] <- "bonobo"
             }
   }

  
mean(teste$especie == resultados) #acurÃ¡cia do modelo

```
